# Fail2Ban Filter for Nextcloud
# Deploy to: /etc/fail2ban/filter.d/nextcloud.conf
#
# This filter catches:
#   - Failed login attempts
#   - Trusted domain errors
#   - Brute force attempts

[Definition]

# Nextcloud logs failed logins with IP address
# Format: {"reqId":"...","level":2,"time":"...","message":"Login failed: 'username' (Remote IP: '1.2.3.4')"}
failregex = ^.*"message":"Login failed: '.*' \(Remote IP: '<ADDR>'\)".*$
            ^.*"message":"Trusted domain error\. - Remote IP: '<ADDR>'".*$

ignoreregex =
